<!DOCTYPE html>
<html>
<head>
	<title>Enabling Push Notifications</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="imagetoolbar" content="false">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<meta name="author" content="Artisan Mobile" />
	<meta name="description" content="Enabling Push Notifications for Android" />
	<meta name="keywords" content="" />

	<meta name="twitter:card" content="summary" />
	<meta name="twitter:url" content="http://dev.useartisan.com" />
	<meta name="twitter:title" content="Enabling Push Notifications" />
	<meta name="twitter:description" content="Enabling Push Notifications for Android" />
	<meta name="twitter:site" content="@artisanmobile" />
	<meta name="twitter:image" content="http://dev.useartisan.com/images/twitter-card-image.png" />

	<meta property="og:site_name" content="Artisan Developers" />
	<meta property="og:title" content="Enabling Push Notifications" />
	<meta property="og:type" content="article" />
	<meta property="og:article:author" content="Kevin M. Jackson" />
	<meta property="og:url" content="http://dev.useartisan.com" />
  
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script src="/js/waypoints.min.js"></script>
	<script src="/js/waypoints-sticky.min.js"></script>
	<script type="text/javascript" src="//use.typekit.net/zqm4dpz.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

	<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.2.0/base-min.css">
	<link rel="stylesheet" href="/docs.css?1392841087" type="text/css" media="screen" charset="utf-8">
</head>
<body>
<div id="header-wrapper">
	<nav>
		<ul id="primary-nav">
			<li><a href="/" title="" id="logo">
				<svg version="1.1" id="icon" fill="#ffffff" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="36px" width="36px" viewBox="0 0 144 144">
					<g>
						<path d="M11.001,97.171c12.574,0,21.169-8.989,26.592-14.575c-0.685,1.268-1.76,3.106-2.028,7.13c-0.343,5.146,2.883,7.41,6.523,7.41c11.756,0,21.49-15.313,26.176-20.028c3.151-3.17,4.429-3.686,7.166-3.686c1.515,0,2,1.4,2,2.468c0,4.489-7.395,10.992-7.395,15.779c0,3.286,2.102,5.503,7.392,5.503c8.67,0,16.73-7.361,18.731-9.294c-1.73,5.709,0.668,9.294,5.901,9.294c6.934,0,16.543-6.328,18.671-9.255c-0.95,4.409,0.461,9.255,6.01,9.255c5.165,0,10.585-3.469,17.261-9.328v-7.124c-5.301,4.903-9.864,8.877-12.489,8.877c-0.8,0-1.143-0.692-1.143-1.291c0-3.854,10.28-16.128,10.28-20.655c0-2.051-1.667-2.798-3.652-2.79c-2.535,0.01-4.433,0.689-6.143,2.992c-2.146,2.889-4.721,7.375-7.858,10.804c-5.518,6.033-11.253,10.61-14.825,10.61c-1.327,0-1.755-0.771-1.755-1.846c0-4.734,6.176-14.089,10.587-21.646c2.807,0.052,4.836,0.116,5.122,0.116c1.937,0,4.656-0.839,4.656-3.007c0-1.772-1.272-2.949-3.701-2.949c-0.142,0-1.253,0.032-2.968,0.069c0.773-1.667,1.249-3.067,1.249-4.053c0-2.164-0.864-4.023-3.485-3.974c-2.524,0.047-5.582,2.392-8.99,8.136c-5.198-0.027-10.569-0.179-11.096-0.178c-2.483,0-4.674,0.907-4.674,3.094c0,2.082,1.188,2.863,3.499,2.863c0.334,0,4.361-0.109,9.246-0.159c-1.829,3.412-4.306,7.692-7.173,11.688c-4.651,6.479-11.596,11.916-15.848,11.916c-1.344,0-1.607-0.869-1.607-1.723c0-3.468,8.203-11.075,8.203-17.023c0-4.28-4.111-5.701-9.468-5.701c-7.307,0-10.27,1.476-15.537,8.155c-6.085,7.717-14.254,15.772-16.664,15.772c-0.734,0-0.69-1.003-0.645-1.334c0.647-4.726,8.411-14.897,8.756-20.074c0.286-4.287-5.133-5.817-9.356-2.197c-0.778,0.667-20.761,23.426-30.816,23.426c-2.227,0-3.5-1.071-3.5-4.08c0-10.111,15.907-30.34,33.532-30.34c8.127,0,8.339,1.667,12.401,1.667c2.846,0,4.268-1.581,4.268-3.371c0-5.239-6.555-5.683-11.577-5.683C27.471,46.829,0,67.646,0,85.769C0,94.921,6.029,97.171,11.001,97.171z"/>
						<path d="M138.128,55.695c0,2.164,1.623,4.103,4.181,4.103c0.596,0,1.161-0.063,1.691-0.179V50.15c-0.059-0.002-0.108-0.015-0.168-0.015C141.424,50.135,138.128,51.694,138.128,55.695z"/>
					</g>
					<path d="M141,3v138H3V3H141 M144,0H0v144h144V0L144,0z"/>
				</svg>
			</a></li>
			<li><a href="/user-guide" title="">Getting Started</a></li>
			<li><a href="/dev/ios/install" title="">iOS Developers</a></li>
			<li><a href="/dev/android/install" title="">Android Developers</a></li>
		</ul>

		<ul id="extra-links">
			<li><a href="http://useartisan.com" title="">Artisan Home</a></li>
			<li><a href="http://useartisan.com/blog" title="">Blog</a></li>
		</ul>
	</nav>
</div>
<div id="main">
  <div class="main-wrapper">
    <section>
      <aside id="category-nav">
        <div id="nav-wrapper">
          




  <h2>Android SDK</h2>
  <ul>
    <li><a href="/dev/android/install/">Installation</a></li>
    <li><a href="/dev/android/user-profiles/">User Profiles</a></li>
    <li><a href="/dev/android/event-tracking/">Event Tracking</a></li>
    <li><a href="/dev/android/power-hooks/">Power Hooks</a></li>
    <li><a href="/dev/android/push-notifications/">Push Notifications</a></li>
    <li><a href="/dev/android/incode-experiments/">In-Code Experiments</a></li>
    <li><a href="/dev/android/javadocs/">API Javadocs</a></li>
  </ul>


        </div>
      </aside>
      <article>
        <h1 id="enabling-push-notifications">Enabling Push Notifications</h1>

<p>Through Artisan you can configure Campaigns to send out targeted push messages to your app users and automatically gather analytics about message open rates, and in-app behavior before and after the message. Messages can be configured from Artisan Tools to open your app or to execute a Power Hook block.</p>

<p>Enabling Artisan Push includes the following steps:</p>

<ol>
  <li><a href="#gcm">Enable Google Cloud Messaging</a></li>
  <li><a href="#artisan-version">Verify Artisan SDK version and Configuration</a></li>
  <li><a href="#app-settings">Set Server API Key in Artisan Tools</a></li>
  <li><a href="#test">Send a Test Message</a></li>
  <li><a href="#done">Build your Campaigns</a></li>
</ol>

<div id="gcm"></div>

<h2 id="enable-google-cloud-messaging">1. Enable Google Cloud Messaging</h2>

<p>If you haven’t already, you need to create a project for your app in the <a target="_blank" href="https://console.developers.google.com">Google Developers Console</a>. For more help see <a href="http://developer.android.com/google/gcm/gs.html">the Android developer docs for enabling GCM</a>.</p>

<p>Make sure that you have enabled Google Cloud Messaging for your app under APIs &amp; auth -&gt; APIs</p>

<p><img src="/images/screens/android-push-gcm-enabled-700x219.png" /></p>

<div class="note note-hint">
    <p>Your app will need to have the Google Play Services Library as a dependency, if it doesn't already. For more information on setting this up see <a target="_blank" href="http://developer.android.com/google/play-services/setup.html">the Android docs for setting up Google Play Services</a>.
</p>
</div>

<div id="artisan-version"></div>

<h2 id="verify-installed-artisan-sdk-version-and-configuration">2. Verify Installed Artisan SDK Version and Configuration</h2>

<h3 id="artisan-version-214-and-above">Artisan version 2.1.4 and above</h3>

<p>Artisan Push Messaging is supported for Artisan Android SDK version 2.1.4 and above.</p>

<div class="note note-hint">
<p>When you run the installer it will automatically add the permissions and services required to handle receiving push messages to your AndroidManifest.xml if they aren't there already.</p>

<p>This includes these permissions:</p>

<pre>
&lt;permission android:name="your.package.name.here.permission.C2D_MESSAGE" android:protectionLevel="signature"/&gt;
<br />
&lt;uses-permission android:name="your.package.name.here.permission.C2D_MESSAGE"/&gt;
<br />
&lt;uses-permission android:name="android.permission.WAKE_LOCK" /&gt;
<br />
&lt;uses-permission android:name="com.google.android.c2dm.permission.RECEIVE"/&gt;
</pre>

<p>As well as this new receiver and service inside the application element</p>

<pre>
&lt;receiver android:name="com.artisan.push.ArtisanPushReceiver" android:permission="com.google.android.c2dm.permission.SEND"&gt;
<br />
&nbsp;&nbsp;&lt;intent-filter&gt;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;action android:name="com.google.android.c2dm.intent.RECEIVE" /&gt;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;category android:name="your.package.name.here" /&gt;
<br />
&nbsp;&nbsp;&lt;/intent-filter&gt;
<br />
&lt;/receiver&gt;
<br />
<br />
  &lt;service android:name="com.artisan.push.ArtisanPushService" /&gt;
  </pre>
</div>

<h3 id="configure-your-sender-id">Configure your Sender ID</h3>

<p>Your Artisan Push Sender ID is the same as your Google Project Number.</p>

<p><img src="/images/screens/android-push-project-number-700x285.png" /></p>

<p>In your Application class you need to set your Push Sender ID in the onCreate of your application before you call ArtisanManager.startArtisan.</p>

<div class="highlight"><pre><code class="java"><span class="kn">import</span> <span class="nn">com.artisan.application.ArtisanApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.artisan.manager.ArtisanManager</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ArtisanDemoApplication</span> <span class="kd">extends</span> <span class="n">ArtisanApplication</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">();</span>

    <span class="c1">// Add this line to enable Artisan Push</span>
    <span class="n">ArtisanManager</span><span class="o">.</span><span class="na">setPushSenderId</span><span class="o">(</span><span class="s">&quot;000012345670000&quot;</span><span class="o">);</span>

    <span class="n">ArtisanManager</span><span class="o">.</span><span class="na">startArtisan</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">&quot;YOUR_ARTISAN_APP_ID&quot;</span><span class="o">);</span>

    <span class="c1">// ...</span>
  <span class="o">}</span>

  <span class="c1">// ...</span>
<span class="o">}</span></code></pre></div>

<div id="app-settings"></div>

<h2 id="set-server-api-key-in-artisan-tools">3. Set Server API Key in Artisan Tools</h2>

<p>In the <a target="_blank" href="https://console.developers.google.com">Google Developers Console</a> for your project you will need to create a new Server API Key for Artisan.</p>

<p>Go to APIs &amp; auth -&gt; Credentials and create a new key, choose “Server Key” and leave the IP address field blank. For more help see <a href="http://developer.android.com/google/gcm/gs.html#access-key">the Android developer docs for obtaining a Server Access Key</a> Copy the key that is generated.</p>

<p><img src="/images/screens/android-push-server-api-key-700x193.png" /></p>

<p>Back in Artisan Tools on the settings page for your app you can add this Server API Key to enable Artisan Push.</p>

<p><img src="/images/screens/android-push-app-settings-448x350.png" /></p>

<div id="test"></div>

<h2 id="send-a-test-message">4. Send a Test Message</h2>

<p>Once you have added your server API key you should send a test message to your device to make sure that everything has been configured correctly.</p>

<p>You will need your test device’s Registration ID. If you run your app from Eclipse or another IDE where you have access to LogCat you will be able to get your Registration ID–Artisan logs the ID each time the app is started up.</p>

<p><img src="/images/screens/android-push-log-registration-id-700x65.png" /></p>

<div class="note note-hint">
    <p><strong>If You Don't See Your Registration ID in the Logs</strong></p>
    <p></p>
    <ul>
      <li><strong>Logging connected?</strong> Check that your device is connected to LogCat and are seeing other log messages for your app. Check to make sure you aren't filtering the logs and that you have them set so that "info" level logs are visible.</li>
      <li><strong>Google Play Services installed?</strong> Check that you have Google Play Services installed and up to date on your device. You can get Google Play Services from the Play Store.</li>
      <li><strong>Sender ID</strong> Double check that the sender ID you set in your application class matches the project number of the project that you enabled Google Cloud Messaging for.</li>
      <li><strong>Permissions correct</strong> Double check that you have the correct permissions in your AndroidManifest.xml. See <a href="#artisan-version">Step 2</a>, above, for details.</li>
      <li><strong>Artisan Version</strong> Check that you have Artisan 2.1.4 or above installed. When you start the app you should see a log message that says "Starting Artisan with App ID : 012301230123 App Version : 1.0 SDK Version : 2.1.4"</li>
    </ul>
</div>

<p>In Artisan Tools on your app settings page there will be a new form from which you can send a test message.</p>

<p><img src="/images/screens/android-push-send-test-message-439x350.png" /></p>

<p>If you do not see this form please make sure you have successfully set your Server API Key in <a href="#app-settings">Step 3<a></a>, above.</a></p>

<div class="note note-hint">
    <p><strong>If You Don't Receive the Test Push Message</strong></p>
    <p>Depending on your network it can take a minute or more for the message to arrive. If you have waited a few minutes and still haven't received the test message there are a few things to check:</p>
    <ul>
      <li><strong>Registration ID</strong> Double check that you correctly copied the Registration ID from the logs for your app. You should not include the part that says "Artisan Push Registration Id: ", just the letters and numbers that come after that.</li>
      <li><strong>GCM enabled?</strong> Go back to step 1 and make sure that GCM is enabled for your project in the Google Developers Console.</li>
      <li><strong>Sender ID</strong> Double check that the sender ID you set in your application class matches the project number of the project that you enabled Google Cloud Messaging for.</li>
      <li><strong>Errors?</strong> Check that there weren't any other errors logged in the console for your app.</li>
    </ul>
    <p>We are always more than happy to help! Send an email to <a href="mailto:support@useartisan.com?Subject=Artisan%20Android%20Push%20Help" target="_top">support@useartisan.com</a> or give us a call at 800.594.0401.</p>
</div>

<div id="done"></div>

<h2 id="build-your-campaign">5. Build your Campaign</h2>

<p>Now that you have successfully set up your App with Google Cloud Messaging and configured Artisan Push you can <a href="/user-guide/campaigns">get started with Push Campaigns</a>.</p>

      </article>
    </section>
  </div>
</div>
<footer>
	<div id="footer" class="wrapper">Copyright  Artisan Mobile, Inc. All rights reserved.</div>
</footer>

<script type="text/javascript" charset="utf-8">
	$(document).ready(function() {
		function toStickOrNotToStick () {
			wHeight = $(window).height();
			navHeight = $("#nav-wrapper").outerHeight(true);

			if(wHeight > navHeight ) {
				if($('#category-nav .sticky-wrapper').length == 0) {
					$('#category-nav #nav-wrapper').waypoint('sticky');
				}
			} else {
				$('#category-nav #nav-wrapper').waypoint('unsticky');
			}

			if($('#category-nav').is(':hidden')) {
				$('#category-nav #nav-wrapper').waypoint('unsticky');	
			}
		}

		$(window).resize(function() {
			toStickOrNotToStick();
		});

		toStickOrNotToStick();
	})
</script>
</body>
</html>