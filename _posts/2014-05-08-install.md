---
layout: docs
title: "Artisan Android Installation"
author: "Artisan"
category: dev/android
description: "Installation instructions for the Artisan Android SDK"
---


# Artisan Android Installation

Before you can start analyzing, personalizing, optimizing, and modifying your app you'll need to install the Artisan SDK. Installing the SDK requires technical knowledge of your app, so if you aren't familiar with the inner workings of your app you can forward this information to your development team.

<ul>
  <li><a href="#prerequisites">Prerequisites</a></li>
  <li><a href="#installation">Installing Artisan</a></li>
  <li><a href="#configuration">Configuring Your Application and Activities</a></li>
  <li><a href="#proguard">ProGuard</a></li>
</ul>

<div id="prerequisites"></div>

##Prerequisites

* Android App with a minimum SDK of no less than Android 2.3.3 (API 10) and build against the latest Android SDK.
* FYI, The following permissions are required to run Artisan. These will be updated during the installation process.

<div class="padding-left-20">
    <ul>
        <li>GET_TASKS - We use this permission to detect when the app is going into the background. This allows us to download and apply view changes in a timely and seamless fashion.</li>
        <li>WRITE_EXTERNAL_STORAGE - This permission is required to save the changeset data</li>
        <li>INTERNET - Artisan uses the internet to download change data for modifications and A/B testing</li>
        <li>ACCESS_NETWORK_STATE - This permission allows us to be smart about when we connect to the internet to download changes</li>
    </ul>
</div>

<div id="installation"></div>

##Installing Artisan

Artisan comes bundled with an installer that will configure your App and add the necessary files to your source root. It will also edit your AndroidManifest.xml to point to the ArtisanService that is needed to instrument your Artisan application. For most cases, we recommend using the installer, but if you prefer to configure the project yourself, please skip forward to the next section.

1\. Download the Artisan Android SDK - You can download the SDK by clicking on your App\'s Settings icon and click the Download SDK link.

2\. Extract YOUAPPNAME-ArtisanInstaller.zip and move the <strong>artisan</strong> folder into your project's root directory.

3\. In a terminal, go to the artisan directory inside your project's root directory and run:

<ul>
    <li>sh install.sh (on Mac/OSX or linux)</li>
    <li>install.bat (on Windows)</li>
</ul>

<div class="note note-hint">
  <p>NOTE: By default the installer is going to ask you if you want to add Artisan Push and use Google Cloud Messaging. You can say no, but if you don't want to be asked you can add the --nopush option when running the installer script, like this:</p>
  <ul>
      <li>sh install.sh --nopush (on Mac/OSX or linux)</li>
      <li>install.bat --nopush (on Windows)</li>
  </ul>
</div>

This will update your manifest file, add the artisan_library.jar to your libs directory and create an Application class, if one doesn't exist already.

If there are any settings in your application's manifest that are not compatible with Artisan you will be notified and the installer will not complete. For example, you must specify a minimum Android SDK of 2.3.3 or higher. Change the specified settings and run the Artisan installer again.

<div class="note note-hint">
  <p>MANUAL INSTALLATION: As an alternative to running the install script (step 3 above) you can make the following changes manually:</p>

  <div class="padding-left-20">

    <p>1. Extract the contents of YOUAPPNAME-ArtisanInstaller.zip into your project's root directory if you didn't do that in step 2 above. Now you should have a folder named "artisan" in the same folder with your AndroidManifest.xml</p>

    <p>2. Copy the artisan_library.jar from the 'artisan/artisan_library/' folder into your project's libs directory. You might need to create this folder in the project's root directory if it does not already exist.</p>

    <p>3. Copy all Android resources from 'artisan/androidResources/res' to your project's 'res' directory. Be sure to keep the subfolder structure intact.</p>

    <p>4. Copy all Android resources from 'artisan/androidResources/assets' to your project's 'assets' directory. (Create assets if it doesn't exist, it should be next to your res folder)</p>

    <p>5. Update your AndroidManifest.xml so that Android knows where to find the service and has the correct permissions.</p>

    Add the following line inside the &#60;application&#62; element.
    {% highlight java %}
    <service android:name="com.artisan.services.ArtisanService"/>
    {% endhighlight %}

    You will also need to add the following permissions to your AndroidManifest.xml outside of the &#60;application&#62; element if they aren't already set:

    {% highlight java %}
<service android:name="com.artisan.services.ArtisanService"/>
<uses-permission android:name="android.permission.GET_TASKS"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
    {% endhighlight %}

  </div>
</div>

That completes the installation of the Artisan SDK, but before you can connect with Artisan you will need to configure your Application and Activities.

<div class="note note-hint">
<p>Gradle Users: If you don't already have all jars in your libs directory added as dependencies in your app's build.gradle file, you will need to add that manually so that the artisan_library.jar gets added as a dependency to your project. Here is an example:</p>
{% highlight groovy %}
dependencies {
  compile files('libs/artisan_library.jar')

}
{% endhighlight %}
</div>

<div class="note note-hint">
<p>Eclipse Users: You'll need to refresh the project in Eclipse so that the newly added files are pulled into the project. Right click on your project and choose "Refresh".</p>
</div>

<div id="configuration"></div>

##Configuring Your Application and Activities

To fully instrument your App you will need to update your Application class and all of your Activities.

### Instrument your Application class

<div class="note note-hint">
  <p>If you didn't have an Application class before you ran the Artisan installer, then an <strong>ArtisanInstrumentedApplication</strong> class was created for you. If you have that you can skip this step and go on to <a href="#instrument-your-activities">instrumenting your Activities</a>.</p>
</div>

If you already have an Application class you will need to update it to extend com.artisan.application.ArtisanApplication or implement com.artisan.application.ArtisanRegisteredApplication.

You will need to implement three required methods in your Application class: registerUserProfileVariables, registerPowerhooks, and registerInCodeExperiments.

You will also need to call ArtisanManager.startArtisan in the onCreate of your Application class.

{% highlight java %}
import com.artisan.application.ArtisanApplication;
import com.artisan.manager.ArtisanManager;

// Extend ArtisanApplication or implement ArtisanRegisteredApplication
public class MySampleApplication extends ArtisanApplication {

  @Override
  public void onCreate() {
    super.onCreate();

    ArtisanManager.startArtisan(this, "YOURAPPIDHERE");
  }


/**
 * Register your Artisan Power Hook variables and Power Hook blocks here
 *
 * See examples at http://docs.useartisan.com/dev/android/power-hooks
 *
 */
@Override
public void registerPowerhooks() {

}

/**
 * Register your Artisan In-code Experiments here
 *
 * See examples at http://docs.useartisan.com/dev/android/incode-experiments
 */
@Override
public void registerInCodeExperiments() {

}

/**
 * Register your Artisan In-code Experiments here
 *
 * See examples at http://docs.useartisan.com/dev/android/user-profiles
 */
@Override
public void registerUserProfileVariables() {

}
{% endhighlight %}

###Instrument your Activities

In order for your app to be properly instrumented all of your activities need to either <strong>extend com.artisan.activity.ArtisanActivity</strong>, or <strong>extend com.artisan.activity.ArtisanFragmentActivity</strong>, or <strong>implement the com.artisan.services.ArtisanBoundActivity</strong> interface.

The simpler option is to extend ArtisanActivity or ArtisanFragmentActivity. There’s nothing else you need to do if you are extending from one of our Activities.

Sample Activity that extends ArtisanActivity:

{% highlight java %}
import com.artisan.activity.ArtisanActivity;

public class BaseActivity extends ArtisanActivity {
  ...
}
{% endhighlight %}

#### Implementing the ArtisanBoundActivity interface

<div class="note note-hint">
  <p>If you are extending ArtisanActivity or ArtisanFragmentActivity for all of your Activities you can skip this section! You are done. Be sure to check out the <a href="#proguard">ProGuard</a> configuration if you are using ProGuard.</p>
</div>

If you are already extending a third party Activity or don’t wish to extend ArtisanActivity or ArtisanFragmentActivity you have the alternative of implementing our interface instead.

If you do, you must also make sure to add implementations for each of these methods and call the respective ArtisanActivity static method.

1\. Implement the ArtisanBoundActivity interface

{% highlight java %}
import com.artisan.services.ArtisanBoundActivity;

public class MyActivity extends Activity implements ArtisanBoundActivity {
    // the rest of your Activity code goes here...
}
{% endhighlight %}

2\. Add or update an implementation for **protected void onCreate(Bundle savedInstanceState)** and call **ArtisanActivity.artisanOnCreate(this)**

{% highlight java %}
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    // Call Artisan method AFTER super.onCreate
    ArtisanActivity.artisanOnCreate(this);
    setContentView(R.layout.activity_sample_layout);
}
{% endhighlight %}

3\. Add or update an implementation for **protected void onStart()** and call **ArtisanActivity.artisanOnStart(this)**

{% highlight java %}
@Override
protected void onStart() {
    super.onStart();
    // Call Artisan method AFTER super.onStart
    ArtisanActivity.artisanOnStart(this);
}
{% endhighlight %}

4\. Add or update an implementation for **protected void onStop()** and call **ArtisanActivity.artisanOnStop(this)**

{% highlight java %}
@Override
protected void onStop() {
    super.onStop();
    // Call Artisan method AFTER super.onStop
    ArtisanActivity.artisanOnStop(this);

}
{% endhighlight %}

5\. Add or update an implementation for **protected void onDestroy()** and call **ArtisanActivity.artisanOnDestroy()**

{% highlight java %}
@Override
protected void onDestroy() {
    // Call Artisan method BEFORE super.onDestroy
    ArtisanActivity.artisanOnDestroy();
    super.onDestroy();
}
{% endhighlight %}

6\. Add an implementation for the version of setContentView that you are using in this Activity and call the corresponding version of **ArtisanActivity.artisanGetContentView** to get the updated contentView

{% highlight java %}
/**
 * This is the version of setContentView that most people use.
 * You only need to implement this if you are using this version
 * of setContentView in this Activity or its subclasses.
 * If you are using it it looks something like this:
 * setContentView(R.layout.activity_main);
 */
@Override
public void setContentView(int layoutResID) {
  View contentView = ArtisanActivity.artisanGetContentView(layoutResID, this);
  super.setContentView(contentView);
}

/**
  * You only need to implement this if you are using this version
  * of setContentView in this Activity or its subclasses. */
@Override
public void setContentView(View view) {
  View contentView = ArtisanActivity.artisanGetContentView(view, this);
  super.setContentView(contentView);
}

/**
  * You only need to implement this if you are using this version
  * of setContentView in this Activity or its subclasses. */
@Override
public void setContentView(View view, LayoutParams params) {
  View contentView = ArtisanActivity.artisanGetContentView(view, params, this);
  super.setContentView(contentView);
}

{% endhighlight %}

7\. Implement **public ArtisanService getArtisanService()** and return **ArtisanActivity._getArtisanService()**

{% highlight java %}
/**
 * This method is required by the ArtisanBoundActivity interface.
 * You can copy this implementation as is
 * to your Activities that extend our interface.
 */
@Override
public ArtisanService getArtisanService() {
  return ArtisanActivity._getArtisanService();
}
{% endhighlight %}

That's it! Each of your Activities that implement ArtisanBoundActivity need to be updated similarly.

<div class="note note-hint">
  <p><strong>PRO TIP:</strong> If you have many classes that need to implement ArtisanBoundActivity we recommend introducing a base class that extends from their common parent and implements our interface. This will help keep your app code as clean as possible with less duplication.</p>
  <p>For example, if you have several classes that extend from ActionBarActivity you could create a MyActionBarActivity class that extends ActionBarActivity and implements ArtisanBoundActivity and includes all of the API calls above. Then you could make all of your Activities extend MyActionBarActivity and be done configuring your Activities for use with Artisan!</p>
</div>

Complete Sample Activity that implements ArtisanBoundActivity:

{% highlight java %}
import android.app.Activity;
import android.view.View;
import android.view.ViewGroup.LayoutParams;

import com.artisan.activity.ArtisanActivity;
import com.artisan.services.ArtisanBoundActivity;
import com.artisan.services.ArtisanService;

public class SampleArtisanCustomerActivity extends Activity implements ArtisanBoundActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        ArtisanActivity.artisanOnCreate(this); // Call Artisan method AFTER super.onCreate
        setContentView(R.layout.activity_absolute_layout);
    }

    @Override
    protected void onStart() {
        super.onStart();
        ArtisanActivity.artisanOnStart(this); // Call Artisan method AFTER super.onStart
    }

    @Override
    protected void onStop() {
        super.onStop();
        ArtisanActivity.artisanOnStop(this); // Call Artisan method AFTER super.onStop
    }

    @Override
    protected void onDestroy() {
        ArtisanActivity.artisanOnDestroy(); // Call Artisan method BEFORE super.onDestroy
        super.onDestroy();
    }

        /**
         * This is the version of setContentView that most people use.
         * You only need to implement this if you are using this version of setContentView in this Activity or its subclasses.
         * If you are using it it looks something like this:
         * setContentView(R.layout.activity_main);
         */
    @Override
    public void setContentView(int layoutResID) {
        View contentView = ArtisanActivity.artisanGetContentView(layoutResID, this);
        super.setContentView(contentView);
    }

        // You only need to implement this if you are using this version of setContentView in this Activity or its subclasses.
    @Override
    public void setContentView(View view) {
        View contentView = ArtisanActivity.artisanGetContentView(view, this);
        super.setContentView(contentView);
    }

        // You only need to implement this if you are using this version of setContentView in this Activity or its subclasses.
    @Override
    public void setContentView(View view, LayoutParams params) {
        View contentView = ArtisanActivity.artisanGetContentView(view, params, this);
        super.setContentView(contentView);
    }

        /**
         * This method is required by the ArtisanBoundActivity interface.
         * You can copy this implementation as is to your Activities that extend our interface.
         */
    @Override
    public ArtisanService getArtisanService() {
        return ArtisanActivity._getArtisanService();
    }
}
{% endhighlight %}


## ProGuard
If you are using ProGuard you will need to follow additional configuration steps to get Artisan working for your release builds. See
<a href="/dev/android/proguard/">http://docs.useartisan.com/dev/android/proguard/</a>
